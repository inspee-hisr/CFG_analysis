#' # Protection status species
#'
## ---- warning=FALSE, message=FALSE, echo=FALSE---------------------------
species_protection <- strsplit(x = species$Protection_Status,split = "|",fixed=TRUE)
species_protection_data <- data_frame(Species_Protection=unlist(species_protection),Species=rep.int(species$Species_Full_Name,times = sapply(species_protection,length)),Class=rep.int(species$Class,times = sapply(species_protection,length)),Classification=rep.int(species$Classification,times = sapply(species_protection,length)))
species_protection_data_summary <- species_protection_data %>% group_by(Species_Protection) %>% summarise(number_of_species=n())
# ggplot()+
#   geom_col(data = species_protection_data_summary, aes(x=Species_Protection, y= number_of_species, fill=Species_Protection),show.legend = F)+
#   geom_text(data = species_protection_data_summary,aes(x =Species_Protection,y= number_of_species, label=number_of_species), position=position_dodge(width=0.7), vjust=-0.25,size=2.8)+
#   scale_y_continuous(breaks = seq(0,780,50),limits = c(0,780))+
#   #ggtitle("Inferring methods of the Sign Score of the PPI network of Drosophila gene")+
#   labs(x="Protection", y= "Number of species")+
#   theme_bw()+
#   theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),axis.text.x = element_text(angle = 45, hjust = 1))
#
# ggsave("species_protection_data_summary.jpeg", plot = last_plot(), device = "jpeg", dpi = 300,path = "Plots/")
#
kable(x = species_protection_data_summary)
#'
## ---- warning=FALSE, message=FALSE, echo=FALSE---------------------------
species_protection_data_classification <- species_protection_data %>% mutate(Protection_Status=if_else(is.na(Species_Protection)==TRUE,"Not protected","Protected")) %>% distinct(Classification,Protection_Status,Species) %>% group_by(Classification,Protection_Status) %>% summarise(number_of_species=n()) %>% ungroup() %>% spread(key = Protection_Status,value = number_of_species,fill=0) %>% gather(key =Protection_Status,value =number_of_species,  -Classification)
species_protection_data_classification$Classification <- factor(species_protection_data_classification$Classification,levels = c("Accidental","Trogloxene","Stygoxene","Stygophile","Troglophile","Stygobiont","Troglobiont"))
species_protection_data_classification_plot <- ggplot()+
geom_col(data = species_protection_data_classification, aes(x=Classification, y= number_of_species, fill=Protection_Status,group=Protection_Status),position="dodge",show.legend = T)+
geom_text(data = species_protection_data_classification,aes(x =Classification,y= number_of_species, label=number_of_species,group=Protection_Status), position=position_dodge(width=0.93), vjust=-0.25,size=6)+
scale_y_continuous(breaks = seq(0,300,25),limits = c(0,300),expand = c(0.01,0.4))+
scale_fill_manual(values = c("lightcoral","lightgreen"),name="")+
labs(x="Classification", y= "Number of species")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),legend.text = element_text(size = 18),axis.text.y=element_text(margin = margin(t = 0, r = 0, b = 0, l = 10,unit = "pt"),size = 18),axis.text.x = element_text(margin = margin(t = 0, r = 0, b = 10, l = 0,unit = "pt"),angle = 45, hjust = 1,size = 18),axis.title = element_text(size=22),panel.border = element_blank(),axis.line.x = element_line(colour = 'black', size = 0.3), axis.line.y = element_line(colour = 'black', size = 0.3),legend.position = c(0.09,0.90), legend.key.size = unit(1.5, "cm"))
ggsave("species_protection_data_classification.png", plot = species_protection_data_classification_plot, device = "png",width = 20,height = 11.25,units = "in", dpi = 100,path = "Website_plots/")
#'
#' ![Number of protected species across their ecological classification](Website_plots/species_protection_data_classification.png)
#'
#'
## ---- warning=FALSE, message=FALSE, echo=FALSE---------------------------
species_protection_data_classification %>% spread(key = Protection_Status,value = number_of_species,fill=0) %>% kable()
#'
#'
#' # Species per cave
#'
## ---- warning=FALSE, message=FALSE, echo=FALSE---------------------------
census_caves_per_species <- census_all_species %>% filter(species_epithet!="sp.") %>% distinct(Species,Cave_ID, Cave_Name,Classification) %>% group_by(Species) %>% summarise(number_of_caves=n()) %>% arrange(desc(number_of_caves))
census_species_per_cave <- census_all_species %>% filter(species_epithet!="sp.") %>% distinct(Species,Cave_ID, Cave_Name,Classification) %>% group_by(Cave_ID,Cave_Name) %>% summarise(number_of_species=n()) %>% arrange(desc(number_of_species))
census_species_per_cave_dist <- census_species_per_cave %>% group_by(number_of_species) %>% summarise(number_of_caves=n())
ggplot(data=census_species_per_cave_dist)+
#=geom_line(aes(x=number_of_caves, y= number_of_species),color="dodgerblue2",show.legend = F)+
geom_point(aes(x=number_of_caves, y= number_of_species),color="dodgerblue2",show.legend = F, size=1)+
#ggtitle("Species")+
scale_y_continuous(breaks = seq(0,75,5),limits = c(0,75))+
scale_x_continuous(breaks = seq(0,200,25), limits = c(0,200))+
labs(x="Number of caves", y= "Number of species")+
theme_bw()+theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank())
ggsave("census_species_per_cave_dist.jpeg", plot = last_plot(), device = "jpeg", dpi = 300,path = "Plots/")
#'
#'
#'
## ---- warning=FALSE, message=FALSE, echo=FALSE---------------------------
kable(x = head(census_species_per_cave,20))
#'
#' ## Endemic species per region
#'
## ---- warning=FALSE, message=FALSE, echo=FALSE---------------------------
species_region_endemic <- census_all_species_all_caves %>% filter(species_epithet!="sp.") %>% filter(Distribution=="Endemic to Greece") %>% distinct( Species,Region) %>% group_by(Species) %>% summarize(number_of_regions=n()) %>% group_by(number_of_regions) %>% summarise(number_of_species=n())
ggplot(data=species_region_endemic)+
geom_line(aes(x=number_of_regions, y= number_of_species),color="dodgerblue2",show.legend = F)+
geom_point(aes(x=number_of_regions, y= number_of_species),color="dodgerblue2",show.legend = F, size=1)+
ggtitle("Endemic to Greece species appearance in regions")+
scale_y_continuous(breaks = seq(0,375,25),limits = c(0,375))+
scale_x_continuous(breaks = seq(0,8,1), limits = c(0,8))+
labs(x="Number of regions", y= "Number of endemic to Greece species")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
ggsave("dist_species_region_endemic.jpeg", plot = last_plot(), device = "jpeg",width = 13,height = 18,units = "cm", dpi = 300,path = "Plots/")
#'
#'
#' ## Ecological classification
#'
## ---- warning=FALSE, message=FALSE, echo=FALSE---------------------------
#census_species_per_cave_classification <- census_all_species %>% filter(species_epithet!="sp.") %>% distinct(Species,Cave_ID, Cave_Name,Classification) %>% group_by(Cave_ID,Cave_Name,Classification) %>% summarise(number_of_species=n()) %>% arrange(desc(number_of_species)) %>% na.omit() %>% spread(Classification,number_of_species,fill = 0) %>% ungroup() %>% mutate(Troglobiont_species=rowSums(.[9:10]))
census_species_per_cave_classification <- census_all_species %>% filter(species_epithet!="sp.") %>% distinct(Species,Cave_ID, Cave_Name,Classification) %>% group_by(Cave_ID,Cave_Name,Classification) %>% summarise(number_of_species=n()) %>% arrange(desc(number_of_species)) %>% na.omit()
census_species_per_cave_classification_trogl <- census_species_per_cave_classification %>% filter(Classification=="Troglobiont")%>% distinct(Cave_ID, Cave_Name, Classification,number_of_species) %>% arrange(desc(Classification))
kable(x = head(census_species_per_cave_classification_trogl,20))
#'
#' # Taxon Occurencies Distribution
#'
#' * Species, Genera, Families abudance in caves of Greece
#'
## ---- warning=FALSE, message=FALSE, echo=FALSE---------------------------
# Species occurencies distributions
species_occurencies_caves <- census_all_species %>% group_by(Species) %>% filter(species_epithet!="sp.") %>% summarise(taxon_occurences=n()) %>% group_by(taxon_occurences) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Species")
dist_species_occurencies_caves <- ggplot(data=species_occurencies_caves)+
geom_line(aes(x=taxon_occurences, y= number_of_taxon),color="dodgerblue2",show.legend = F)+
geom_point(aes(x=taxon_occurences, y= number_of_taxon),color="dodgerblue2",show.legend = F, size=1)+
ggtitle("Species")+
scale_y_continuous(breaks = seq(0,600,100),limits = c(0,600))+
scale_x_continuous(breaks = seq(0,90,10), limits = c(0,90))+
#labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
# Genera occurencies distributions
genera_occurencies_caves <- census_all_species %>% group_by(Genus) %>% summarise(taxon_occurences=n()) %>% group_by(taxon_occurences) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Genus")
dist_genera_occurencies_caves <-  ggplot(data=genera_occurencies_caves)+
geom_line(aes(x=taxon_occurences, y= number_of_taxon),color="orange",show.legend = F)+
geom_point(aes(x=taxon_occurences, y= number_of_taxon),color="orange",show.legend = F, size=1)+
ggtitle("Genus")+
scale_y_continuous(breaks = seq(0,210,50),limits = c(0,210))+
scale_x_continuous(breaks = seq(0,210,50), limits = c(0,210))+
#labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
# Family occurencies distribution
family_occurencies_caves <- census_all_species %>% group_by(Family) %>% summarise(taxon_occurences=n()) %>% group_by(taxon_occurences) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Family")
dist_family_occurencies_caves <- ggplot(data=family_occurencies_caves)+
geom_line(aes(x=taxon_occurences, y= number_of_taxon),color="turquoise",show.legend = F)+
geom_point(aes(x=taxon_occurences, y= number_of_taxon),color="turquoise",show.legend = F, size=1)+
ggtitle("Family")+
scale_x_continuous(breaks = seq(0,250,50),limits = c(0,250))+
scale_y_continuous(breaks = seq(0,90,20), limits = c(0,90))+
#labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
# Order occurencies distributions
order_occurencies_caves <- census_all_species %>% group_by(Order) %>% summarise(taxon_occurences=n()) %>% group_by(taxon_occurences) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Order")
dist_order_occurencies_caves <- ggplot(data=order_occurencies_caves)+
geom_line(aes(x=taxon_occurences, y= number_of_taxon),color="purple",show.legend = F)+
geom_point(aes(x=taxon_occurences, y= number_of_taxon),color="purple",show.legend = F, size=1)+
ggtitle("Order")+
scale_x_continuous(breaks = seq(0,600,100),limits = c(0,600))+
scale_y_continuous(breaks = seq(0,20,5), limits = c(0,20))+
#labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
## Class occurencies
class_occurencies_caves <- census_all_species %>% group_by(Class) %>% summarise(taxon_occurences=n()) %>% group_by(taxon_occurences) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Class")
dist_class_occurencies_caves <- ggplot(data=class_occurencies_caves)+
geom_line(aes(x=taxon_occurences, y= number_of_taxon),color="red",show.legend = F)+
geom_point(aes(x=taxon_occurences, y= number_of_taxon),color="red",show.legend = F, size=1)+
ggtitle("Class")+
scale_y_continuous(breaks = seq(0,5,1),limits = c(0,4))+
scale_x_continuous(breaks = seq(0,900,150), limits = c(0,900))+
labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
## Merge distributions
occurences_taxa <- do.call("rbind",list(species_occurencies_caves,genera_occurencies_caves,family_occurencies_caves,order_occurencies_caves,class_occurencies_caves))
### Arrange plots
distributions_occurences_taxa <- grid.arrange(dist_species_occurencies_caves,arrangeGrob(dist_genera_occurencies_caves,dist_family_occurencies_caves,dist_order_occurencies_caves,dist_class_occurencies_caves,ncol=2),nrow = 2,bottom=textGrob("Number of occurencies in caves", gp=gpar(fontface="plain", col="black", fontsize=11)),left=textGrob("Number of taxa", gp=gpar(fontface="plain", col="black",fontsize=11), rot=90), heights=c(0.35,0.65))
ggsave("distributions_distributions_occurences_taxa.jpeg", plot = distributions_occurences_taxa, device = "jpeg",width = 13,height = 18,units = "cm", dpi = 300,path = "Plots/")
#'
#' ## Without chiroptera
#'
## ---- warning=FALSE, message=FALSE, echo=FALSE---------------------------
species_occurencies_no_chiroptera <- census_all_species %>% filter(Order!="Chiroptera",species_epithet!="sp.")
# Species occurencies distributions
species_occurencies_caves <- species_occurencies_no_chiroptera %>% group_by(Species) %>% summarise(taxon_occurences=n()) %>% group_by(taxon_occurences) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Species")
dist_species_occurencies_caves <- ggplot(data=species_occurencies_caves)+
geom_line(aes(x=taxon_occurences, y= number_of_taxon),color="dodgerblue2",show.legend = F)+
geom_point(aes(x=taxon_occurences, y= number_of_taxon),color="dodgerblue2",show.legend = F, size=1)+
ggtitle("Species")+
scale_y_continuous(breaks = seq(0,600,100),limits = c(0,600))+
scale_x_continuous(breaks = seq(0,50,5), limits = c(0,50))+
#labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
# Genera occurencies distributions
genera_occurencies_caves <- species_occurencies_no_chiroptera %>% group_by(Genus) %>% summarise(taxon_occurences=n()) %>% group_by(taxon_occurences) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Genus")
dist_genera_occurencies_caves <-  ggplot(data=genera_occurencies_caves)+
geom_line(aes(x=taxon_occurences, y= number_of_taxon),color="orange",show.legend = F)+
geom_point(aes(x=taxon_occurences, y= number_of_taxon),color="orange",show.legend = F, size=1)+
ggtitle("Genus")+
scale_y_continuous(breaks = seq(0,210,50),limits = c(0,210))+
scale_x_continuous(breaks = seq(0,210,25), limits = c(0,150))+
#labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
# Family occurencies distribution
family_occurencies_caves <- species_occurencies_no_chiroptera %>% group_by(Family) %>% summarise(taxon_occurences=n()) %>% group_by(taxon_occurences) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Family")
dist_family_occurencies_caves <- ggplot(data=family_occurencies_caves)+
geom_line(aes(x=taxon_occurences, y= number_of_taxon),color="turquoise",show.legend = F)+
geom_point(aes(x=taxon_occurences, y= number_of_taxon),color="turquoise",show.legend = F, size=1)+
ggtitle("Family")+
scale_x_continuous(breaks = seq(0,150,25),limits = c(0,150))+
scale_y_continuous(breaks = seq(0,90,20), limits = c(0,90))+
#labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
# Order occurencies distributions
order_occurencies_caves <- species_occurencies_no_chiroptera %>% group_by(Order) %>% summarise(taxon_occurences=n()) %>% group_by(taxon_occurences) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Order")
dist_order_occurencies_caves <- ggplot(data=order_occurencies_caves)+
geom_line(aes(x=taxon_occurences, y= number_of_taxon),color="purple",show.legend = F)+
geom_point(aes(x=taxon_occurences, y= number_of_taxon),color="purple",show.legend = F, size=1)+
ggtitle("Order")+
scale_x_continuous(breaks = seq(0,600,100),limits = c(0,600))+
scale_y_continuous(breaks = seq(0,20,5), limits = c(0,20))+
#labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
## Class occurencies
class_occurencies_caves <- species_occurencies_no_chiroptera %>% group_by(Class) %>% summarise(taxon_occurences=n()) %>% group_by(taxon_occurences) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Class")
dist_class_occurencies_caves <- ggplot(data=class_occurencies_caves)+
geom_line(aes(x=taxon_occurences, y= number_of_taxon),color="red",show.legend = F)+
geom_point(aes(x=taxon_occurences, y= number_of_taxon),color="red",show.legend = F, size=1)+
ggtitle("Class")+
scale_y_continuous(breaks = seq(0,5,1),limits = c(0,4))+
scale_x_continuous(breaks = seq(0,900,150), limits = c(0,900))+
labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
## Merge distributions
occurences_taxa <- do.call("rbind",list(species_occurencies_caves,genera_occurencies_caves,family_occurencies_caves,order_occurencies_caves,class_occurencies_caves))
### Arrange plots
distributions_occurences_taxa <- grid.arrange(dist_species_occurencies_caves,arrangeGrob(dist_genera_occurencies_caves,dist_family_occurencies_caves,dist_order_occurencies_caves,dist_class_occurencies_caves,ncol=2),nrow = 2,bottom=textGrob("Number of occurencies in caves", gp=gpar(fontface="plain", col="black", fontsize=11)),left=textGrob("Number of taxa (no chiroptera)", gp=gpar(fontface="plain", col="black",fontsize=11), rot=90), heights=c(0.35,0.65))
ggsave("distributions_distributions_occurences_taxa_no_chiroptera.jpeg", plot = distributions_occurences_taxa, device = "jpeg",width = 13,height = 18,units = "cm", dpi = 300,path = "Plots/")
#'
#' ## Only chiroptera
#'
## ---- warning=FALSE, message=FALSE, echo=FALSE---------------------------
species_occurencies_only_chiroptera <- census_all_species %>% filter(Order=="Chiroptera", species_epithet!="sp.")
species_occurencies_only_chiroptera2 <- species_occurencies_only_chiroptera %>% dplyr::select(Order,Family,Genus,Species) %>% distinct()
# Species occurencies distributions
species_occurencies_caves <- species_occurencies_only_chiroptera %>% group_by(Species) %>% summarise(taxon_occurences=n()) %>% group_by(taxon_occurences) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Species")
dist_species_occurencies_caves <- ggplot(data=species_occurencies_caves)+
geom_line(aes(x=taxon_occurences, y= number_of_taxon),color="dodgerblue2",show.legend = F)+
geom_point(aes(x=taxon_occurences, y= number_of_taxon),color="dodgerblue2",show.legend = F, size=1)+
ggtitle("Species")+
#scale_y_continuous(breaks = seq(0,600,100),limits = c(0,600))+
scale_x_continuous(breaks = seq(0,50,5), limits = c(0,50))+
#labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
# Genera occurencies distributions
genera_occurencies_caves <- species_occurencies_only_chiroptera %>% group_by(Genus) %>% summarise(taxon_occurences=n()) %>% group_by(taxon_occurences) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Genus")
dist_genera_occurencies_caves <-  ggplot(data=genera_occurencies_caves)+
geom_line(aes(x=taxon_occurences, y= number_of_taxon),color="orange",show.legend = F)+
geom_point(aes(x=taxon_occurences, y= number_of_taxon),color="orange",show.legend = F, size=1)+
ggtitle("Genus")+
scale_y_continuous(breaks = seq(0,3,1),limits = c(0,3))+
scale_x_continuous(breaks = seq(0,210,25), limits = c(0,150))+
#labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
# Family occurencies distribution
family_occurencies_caves <- species_occurencies_only_chiroptera %>% group_by(Family) %>% summarise(taxon_occurences=n()) %>% group_by(taxon_occurences) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Family")
# dist_family_occurencies_caves <- ggplot(data=family_occurencies_caves)+
#   geom_line(aes(x=taxon_occurences, y= number_of_taxon),color="turquoise",show.legend = F)+
#   geom_point(aes(x=taxon_occurences, y= number_of_taxon),color="turquoise",show.legend = F, size=1)+
#   ggtitle("Family")+
#   scale_x_continuous(breaks = seq(0,150,25),limits = c(0,150))+
#   scale_y_continuous(breaks = seq(0,90,20), limits = c(0,90))+
#   #labs(x="Number of species", y= "Number of taxa")+
#   theme_bw()+
#   theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
# Order occurencies distributions
order_occurencies_caves <- species_occurencies_only_chiroptera %>% group_by(Order) %>% summarise(taxon_occurences=n()) %>% group_by(taxon_occurences) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Order")
# dist_order_occurencies_caves <- ggplot(data=order_occurencies_caves)+
#   geom_line(aes(x=taxon_occurences, y= number_of_taxon),color="purple",show.legend = F)+
#   geom_point(aes(x=taxon_occurences, y= number_of_taxon),color="purple",show.legend = F, size=1)+
#   ggtitle("Order")+
#   scale_x_continuous(breaks = seq(0,600,100),limits = c(0,600))+
#   scale_y_continuous(breaks = seq(0,20,5), limits = c(0,20))+
#   #labs(x="Number of species", y= "Number of taxa")+
#   theme_bw()+
#   theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
## Class occurencies
class_occurencies_caves <- species_occurencies_only_chiroptera %>% group_by(Class) %>% summarise(taxon_occurences=n()) %>% group_by(taxon_occurences) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Class")
# dist_class_occurencies_caves <- ggplot(data=class_occurencies_caves)+
#   geom_line(aes(x=taxon_occurences, y= number_of_taxon),color="red",show.legend = F)+
#   geom_point(aes(x=taxon_occurences, y= number_of_taxon),color="red",show.legend = F, size=1)+
#   ggtitle("Class")+
#   scale_y_continuous(breaks = seq(0,5,1),limits = c(0,4))+
#   scale_x_continuous(breaks = seq(0,900,150), limits = c(0,900))+
#   labs(x="Number of species", y= "Number of taxa")+
#   theme_bw()+
#   theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
## Merge distributions
occurences_taxa <- do.call("rbind",list(species_occurencies_caves,genera_occurencies_caves,family_occurencies_caves,order_occurencies_caves,class_occurencies_caves))
### Arrange plots
distributions_occurences_taxa <- grid.arrange(dist_species_occurencies_caves,dist_genera_occurencies_caves,nrow = 2,bottom=textGrob("Number of occurencies in caves", gp=gpar(fontface="plain", col="black", fontsize=11)),left=textGrob("Number of taxa (only chiroptera)", gp=gpar(fontface="plain", col="black",fontsize=11), rot=90), heights=c(0.35,0.65))
ggsave("distributions_distributions_occurences_taxa_only_chiroptera.jpeg", plot = distributions_occurences_taxa, device = "jpeg",width = 13,height = 18,units = "cm", dpi = 300,path = "Plots/")
#'
#' ## Taxon - Subtaxon Distribution
#'
#'
## ---- warning=FALSE, message=FALSE, echo=FALSE---------------------------
# Genus
species_occurencies_unique_species_genus_dist <- species %>% dplyr::select(Species_Full_Name,Genus) %>% distinct() %>% group_by(Genus) %>% summarise(number_of_species=n()) %>% group_by(number_of_species) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Genus")
# Family
species_occurencies_unique_species_Family_dist <- species %>% dplyr::select(Species_Full_Name,Family) %>% distinct() %>% group_by(Family) %>% summarise(number_of_species=n()) %>% group_by(number_of_species) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Family")
# Order
species_occurencies_unique_species_Order_dist <- species %>% dplyr::select(Species_Full_Name,Order) %>% distinct() %>% group_by(Order) %>% summarise(number_of_species=n()) %>% group_by(number_of_species) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Order")
# Class
species_occurencies_unique_species_Class_dist <- species %>% dplyr::select(Species_Full_Name,Class) %>% distinct() %>% group_by(Class) %>% summarise(number_of_species=n()) %>% group_by(number_of_species) %>% summarise(number_of_taxon=n()) %>% mutate(taxon="Class")
species_taxon_distributions <- do.call("rbind", list(species_occurencies_unique_species_genus_dist, species_occurencies_unique_species_Family_dist, species_occurencies_unique_species_Order_dist,species_occurencies_unique_species_Class_dist))
ggplot()+
geom_point(data = species_taxon_distributions, aes(x=number_of_species, y= number_of_taxon, color=taxon),show.legend = T)+
#ggtitle("Inferring methods of the Sign Score of the PPI network of Drosophila gene")+
scale_y_continuous(breaks = seq(0,320,20),limits = c(0,320))+
scale_x_continuous(breaks = seq(0,280,20),limits = c(0,280))+
labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank())
ggsave("species_taxon_distributions_plot.jpeg", plot = last_plot(), device = "jpeg", dpi = 300,path = "Plots/")
#'
## ---- warning=FALSE, message=FALSE, echo=FALSE---------------------------
dist_class <- species_taxon_distributions %>% filter(taxon=="Class") %>%
ggplot(data=.)+
geom_line(aes(x=number_of_species, y= number_of_taxon),color="red",show.legend = F)+
geom_point(aes(x=number_of_species, y= number_of_taxon),color="red",show.legend = F, size=1)+
ggtitle("Class")+
scale_y_continuous(breaks = seq(0,5,1),limits = c(0,4))+
scale_x_continuous(breaks = seq(0,300,50), limits = c(0,300))+
labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
dist_order <- species_taxon_distributions %>% filter(taxon=="Order") %>%
ggplot(data=.)+
geom_line(aes(x=number_of_species, y= number_of_taxon),color="purple",show.legend = F)+
geom_point(aes(x=number_of_species, y= number_of_taxon),color="purple",show.legend = F, size=1)+
ggtitle("Order")+
scale_y_continuous(breaks = seq(0,20,5),limits = c(0,20))+
scale_x_continuous(breaks = seq(0,180,20), limits = c(0,180))+
#labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
dist_family <- species_taxon_distributions %>% filter(taxon=="Family") %>%
ggplot(data=.)+
geom_line(aes(x=number_of_species, y= number_of_taxon),color="turquoise",show.legend = F)+
geom_point(aes(x=number_of_species, y= number_of_taxon),color="turquoise",show.legend = F, size=1)+
ggtitle("Family")+
scale_y_continuous(breaks = seq(0,120,20),limits = c(0,120))+
scale_x_continuous(breaks = seq(0,80,10), limits = c(0,70))+
#labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
dist_genus <- species_taxon_distributions %>% filter(taxon=="Genus") %>%
ggplot(data=.)+
geom_line(aes(x=number_of_species, y= number_of_taxon),color="orange",show.legend = F)+
geom_point(aes(x=number_of_species, y= number_of_taxon),color="orange",show.legend = F, size=1)+
ggtitle("Genus")+
scale_y_continuous(breaks = seq(0,300,50),limits = c(0,300))+
scale_x_continuous(breaks = seq(0,30,5), limits = c(0,30))+
#labs(x="Number of species", y= "Number of taxa")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(),plot.title = element_text(hjust = 0.5, size = 11))
distributions_species_taxon <- grid.arrange(arrangeGrob(grobs = list(dist_class,dist_order,dist_family,dist_genus)), ncol=2,bottom=textGrob("Number of species", gp=gpar(fontface="plain", col="black", fontsize=11)), left=textGrob("Number of taxa", gp=gpar(fontface="plain", col="black",fontsize=11), rot=90),widths=c(9,0.5))
ggsave("distributions_species_taxon.jpeg", plot = distributions_species_taxon, device = "jpeg", dpi = 300,path = "Plots/")
#'
## ---- warning=FALSE, message=FALSE, echo=FALSE, eval=FALSE---------------
## #determine order of appearance in facet_wrap
##
## species_taxon_distributions$taxon_order <- factor(species_taxon_distributions$taxon, levels = c("Class","Order","Family","Genus"))
##
## ggplot()+
##   geom_line(data = species_taxon_distributions, aes(x=number_of_species, y= number_of_taxon,colour = factor(taxon)),show.legend = F)+
##   geom_point(data = species_taxon_distributions, aes(x=number_of_species, y= number_of_taxon,colour = factor(taxon)),show.legend = F, size=1)+
##   #scale_y_continuous(breaks = )+
##   #scale_x_continuous(breaks = seq(0,280,20))+
##   labs(x="Number of species", y= "Number of taxa")+
##   theme_bw()+
##   theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank())+
##   facet_wrap( ~ taxon_order,scales = "free")
##
## ggsave("species_taxon_distributions_plot_facet.jpeg", plot = last_plot(), device = "jpeg", dpi = 300,path = "Plots/")
#'
#' # Links to other databases
#'
#' Cave Fauna of Greece database includes links of species to GBIF, Fauna Europea, IUCN, PESI and NCBI Taxonomy.
#'
## ----warning=FALSE, message=FALSE, echo=FALSE----------------------------
species_links <- species %>% dplyr::select(Link_IUCN,Link_GBIF,Link_Fauna_Europaea,Link_NCBI,Link_PESI)
species_links_summary <- data_frame(Source=c("Fauna Europaea","NCBI Taxonomy","GBIF","PESI","IUCN", "Total Species"), Number_of_links=c(sum(!is.na(species_links$Link_Fauna_Europaea)),sum(!is.na(species_links$Link_NCBI)),sum(!is.na(species_links$Link_GBIF)),sum(!is.na(species_links$Link_PESI)),sum(!is.na(species_links$Link_IUCN)), nrow(species_links)), Missing_links=c(nrow(species)-sum(!is.na(species_links$Link_Fauna_Europaea)),nrow(species)-sum(!is.na(species_links$Link_NCBI)),nrow(species)-sum(!is.na(species_links$Link_GBIF)),nrow(species)-sum(!is.na(species_links$Link_PESI)),nrow(species)-sum(!is.na(species_links$Link_IUCN)),nrow(species_links)-nrow(species_links))) %>% mutate(frequency=round(Number_of_links/nrow(species),digits = 3))
kable(species_links_summary)
#'
#' Bar plots of the links.
#'
## ----warning=FALSE, message=FALSE, echo=FALSE----------------------------
ggplot()+
geom_col(data = species_links_summary, aes(x=Source, y= Number_of_links, fill=Source),show.legend = F)+
geom_text(data = species_links_summary,aes(x =Source,y= Number_of_links, label=Number_of_links), position=position_dodge(width=0.7), vjust=-0.25,size=2.8)+
scale_y_continuous(breaks = seq(0,nrow(species),100),limits = c(0,nrow(species)))+
labs(x="Database", y= "Number of species links")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),axis.text.x = element_text(angle = 45, hjust = 1))
ggsave("species_links_summary.jpeg", plot = last_plot(), device = "jpeg", dpi = 300,path = "Plots/")
ggplot()+
geom_col(data = species_links_summary, aes(x=Source, y= frequency, fill=Source),show.legend = F)+
geom_text(data = species_links_summary,aes(x =Source,y= frequency, label=frequency), position=position_dodge(width=0.7), vjust=-0.25,size=2.8)+
scale_y_continuous(breaks = seq(0,1,0.1),limits = c(0,1))+
labs(x="Database", y= "Frequency of species links")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),axis.text.x = element_text(angle = 45, hjust = 1))
ggsave("species_links_summary_frequency.jpeg", plot = last_plot(), device = "jpeg", dpi = 300,path = "Plots/")
#'
## ----warning=FALSE, message=FALSE, echo=FALSE----------------------------
PESI_vs_Fauna_E <- species %>% filter((is.na(Link_PESI) & !is.na(Link_Fauna_Europaea)) | (is.na(Link_Fauna_Europaea) & !is.na(Link_PESI))) %>% dplyr::select(Species_Full_Name,Link_Fauna_Europaea,Link_PESI)
#'
#'
#' # Census References
#'
## ----warning=FALSE, message=FALSE, echo=FALSE----------------------------
species_references_year_dist <- Census_references %>% group_by(Year) %>% summarise(publications_per_year=n())
ggplot()+
geom_line(data=species_references_year_dist,aes(x=Year, y= publications_per_year),color="red",show.legend = F)+
scale_x_continuous(breaks = seq(1860,2020,10),limits = c(1860,2020))+
scale_y_continuous(breaks = seq(0,20,2), limits = c(0,20))+
labs(x="Years",y="Number of new publications")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank())
ggsave("species_references_year_dist.jpeg", plot = last_plot(), device = "jpeg", dpi = 300,path = "Plots/")
#'
## ----warning=FALSE, message=FALSE, echo=FALSE----------------------------
species_references_year_dist$Cumulative_publications <- cumsum(species_references_year_dist$publications_per_year)
ggplot(data=species_references_year_dist)+
geom_line(aes(x=Year, y= Cumulative_publications),color="mediumseagreen",show.legend = F)+
#ggtitle("Class")+
scale_x_continuous(breaks = seq(1860,2020,10),limits = c(1860,2020))+
scale_y_continuous(breaks = seq(0,750,100), limits = c(0,750))+
labs(x="Years",y="Cumulative publications")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank())
ggsave("species_references_year_dist_cumulative.jpeg", plot = last_plot(), device = "jpeg", dpi = 300,path = "Plots/")
#'
#' * New species discovered in time. (references)
#'
## ----warning=FALSE, message=FALSE, echo=FALSE----------------------------
census_long_man_reference <- census_long_man %>% left_join(Census_references,by=c("ReferenceShort"="Short"))
census$species_epithet <- as.character(lapply(strsplit(as.character(census$Species), split=" "), "[", n=2))
species_references_spreaded_arranged <- census_long_man_reference %>% ungroup() %>% dplyr::select(Species, ReferenceShort, Year) %>% group_by(Species,ReferenceShort, Year) %>% distinct(.) %>% arrange(.,Year) %>% ungroup() %>% mutate(Duplicates=duplicated(Species), species_epithet= as.character(lapply(strsplit(as.character(Species), split=" "), "[", n=2))) %>% filter(species_epithet!="sp.") %>% mutate(.,First_occurance=if_else(Duplicates=="FALSE",1,0)) %>% na.omit() %>% mutate(Cumulative_occurance= cumsum(First_occurance)) %>% mutate(Classification="All species") %>% dplyr::select(-c(Species,species_epithet,First_occurance)) %>% distinct(.)
ggplot()+
geom_line(data=species_references_spreaded_arranged,aes(x=Year, y= Cumulative_occurance),color="violetred1",show.legend = F)+
#ggtitle("Class")+
scale_x_continuous(breaks = seq(1860,2020,10),limits = c(1860,2020))+
scale_y_continuous(breaks = seq(0,950,100), limits = c(0,950))+
labs(x="Years",y="Cumulative species in Greek caves")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank())
ggsave("species_occurrence_accumulation.jpeg", plot = last_plot(), device = "jpeg", dpi = 300,path = "Plots/")
qq <- species %>% filter(Distribution=="Endemic to Greece")
#'
#'
## ----warning=FALSE, message=FALSE, echo=FALSE----------------------------
endemic_cumulative_species <- census_long_man_reference %>% left_join(species,by=c("Species"="Species_Full_Name")) %>% dplyr::select(Species,Distribution, ReferenceShort, Year) %>% group_by(Species,Distribution,ReferenceShort, Year) %>% distinct(.) %>% arrange(.,Year) %>% ungroup() %>% mutate(Duplicates=duplicated(Species), species_epithet= as.character(lapply(strsplit(as.character(Species), split=" "), "[", n=2))) %>% filter(species_epithet!="sp.") %>% mutate(.,First_occurance=if_else(Duplicates=="FALSE",1,0)) %>% na.omit() %>% filter(First_occurance==1) %>% group_by(Year,Distribution) %>% summarise(Occurance_species_year= n()) %>% group_by(Distribution) %>% mutate(Cumulative_occurance= cumsum(Occurance_species_year)) %>% filter(Distribution=="Endemic to Greece") %>% mutate(Classification="Endemic species to Greece") %>% dplyr::select(-Occurance_species_year,-Distribution)
census_long_man_reference_all_species_classification <- census_long_man_reference %>% left_join(species,by=c("Species"="Species_Full_Name")) %>% dplyr::select(Species,Classification, ReferenceShort, Year) %>% group_by(Species,Classification,ReferenceShort, Year) %>% distinct(.) %>% arrange(.,Year) %>% ungroup() %>% mutate(Duplicates=duplicated(Species), species_epithet= as.character(lapply(strsplit(as.character(Species), split=" "), "[", n=2))) %>% filter(species_epithet!="sp.") %>% mutate(.,First_occurance=if_else(Duplicates=="FALSE",1,0)) %>% na.omit() %>% filter(First_occurance==1) %>% group_by(Year,Classification) %>% summarise(Occurance_species_year= n()) %>% group_by(Classification) %>% mutate(Cumulative_occurance= cumsum(Occurance_species_year)) %>% dplyr::select(-Occurance_species_year) %>% bind_rows(species_references_spreaded_arranged) %>% filter(Classification %in% c("Troglobiont","Troglophile","All species")) %>% bind_rows(endemic_cumulative_species)
species_occurrence_accumulation_classification_plot <- ggplot()+
geom_line(data=census_long_man_reference_all_species_classification,aes(x=Year, y= Cumulative_occurance,color=Classification),size=1,show.legend = T)+
#ggtitle("Class")+
scale_x_continuous(breaks = seq(1860,2030,10),limits = c(1860,2030),expand=c(0.015,0))+
scale_y_continuous(breaks = seq(0,950,100), limits = c(0,913),expand = c(0.01,0))+
scale_color_manual(values =c("Endemic species to Greece"="lightcoral","Troglophile"="paleturquoise","Troglobiont"="darkolivegreen3","All species"="deepskyblue"))+
labs(x="Years",y="Cumulative number of species")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),legend.text = element_text(size = 18),axis.text.y=element_text(margin = margin(t = 0, r = 5, b = 0, l = 15,unit = "pt"),size = 18),axis.text.x = element_text(margin = margin(t = 5, r = 0, b = 15, l = 0,unit = "pt"),size = 18),axis.title = element_text(size=22),panel.border = element_blank(),axis.line.x = element_line(colour = 'black', size = 0.3), axis.line.y = element_line(colour = 'black', size = 0.3),legend.position = c(0.13,0.87), legend.key.size = unit(1.5, "cm"), legend.title = element_blank())
ggsave("species_occurrence_accumulation_classification.png", plot = species_occurrence_accumulation_classification_plot, device = "png",width = 20,height = 11.25,units = "in", dpi = 100,path = "Website_plots/")
#'
#' ![Species accumulation from published data](Website_plots/species_occurrence_accumulation_classification.png)
#'
## ----warning=FALSE, message=FALSE, echo=FALSE----------------------------
species_references_spreaded_arranged_article <- species_references_spreaded_arranged %>% filter(Duplicates=="FALSE") %>% group_by(ReferenceShort, Year) %>% summarise(n_new_species=n()) %>% group_by(n_new_species) %>% summarise(n_references=n())
ggplot()+
geom_line(data=species_references_spreaded_arranged_article,aes(y=n_references, x= n_new_species),color="violetred1",show.legend = F)+
#ggtitle("Class")+
scale_x_continuous(breaks = seq(0,180,10),limits = c(0,100))+
scale_y_continuous(breaks = seq(0,180,20),limits = c(0,180))+
labs(x="Number of references",y="Number of new species additions in Greek caves")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank())
ggsave("species_references_spreaded_arranged_article.jpeg", plot = last_plot(), device = "jpeg", dpi = 300,path = "Plots/")
#'
#' ## Classes growth
#'
## ----warning=FALSE, message=FALSE, echo=FALSE----------------------------
census_long_man_reference_all_species <- census_long_man_reference %>% left_join(species,by=c("Species"="Species_Full_Name")) %>% dplyr::select(Species,Class, ReferenceShort, Year) %>% group_by(Species,Class,ReferenceShort, Year) %>% distinct(.) %>% arrange(.,Year) %>% ungroup() %>% mutate(Duplicates=duplicated(Species), species_epithet= as.character(lapply(strsplit(as.character(Species), split=" "), "[", n=2))) %>% filter(species_epithet!="sp.") %>% mutate(.,First_occurance=if_else(Duplicates=="FALSE",1,0)) %>% na.omit() %>% filter(First_occurance==1) %>% mutate(Cumulative_occurance_species= cumsum(First_occurance)) %>% group_by(Year,Class) %>% summarise(Occurance_species_class_year= n()) %>% group_by(Class) %>% mutate(Cumulative_occurance_class= cumsum(Occurance_species_class_year)) %>% filter(Class %in% c("Insecta","Mammalia","Arachnida","Malacostraca"))
ggplot()+
geom_line(data=census_long_man_reference_all_species,aes(y=Cumulative_occurance_class, x= Year, color=Class),show.legend = T)+
#ggtitle("Class")+
scale_x_continuous(breaks = seq(1860,2020,10),limits = c(1860,2020))+
scale_y_continuous(breaks = seq(0,250,25),limits = c(0,250))+
labs(x="Year",y="Cumulative number of species per year")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(), legend.position = c(0.15,0.8))
ggsave("species_class_occurence_accumulation.jpeg", plot = last_plot(), device = "jpeg", dpi = 300,path = "Plots/")
caves_protection_data_summary_type$Protection_Type_l <- factor(gsub(pattern = " ",replacement = "\n",x = caves_protection_data_summary_type$Protection_Type),levels = c("Archaeological\nSite","Historical\nMonument","Landscape\nof\nOutstanding\nNatural\nBeauty","Natura2000","Wildlife\nRefuge","Not\nProtected"))
ggplot()+
geom_col(data = caves_protection_data_summary_type, aes(x=Protection_Type_l, y= number_of_caves, fill=Protection_Type_l),width=0.8,show.legend = F)+
geom_text(data = caves_protection_data_summary_type,aes(x =Protection_Type_l,y= number_of_caves, label=number_of_caves), position=position_dodge(width=0.7), vjust=-0.25,size=5)+
scale_y_continuous(breaks = seq(0,350),limits = c(0,350))+
#scale_x_discrete(labels=Protection_Type_label)+
labs(x="Protection", y= "Number of caves")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),legend.text = element_text(size = 18),axis.text.y=element_text(margin = margin(t = 0, r = 0, b = 0, l = 10,unit = "pt"),size = 18),axis.text.x = element_text(size = 18,angle = 45, hjust = 1),axis.title = element_text(size=22),panel.border = element_blank(),axis.line.x = element_line(colour = 'black', size = 0.3), axis.line.y = element_line(colour = 'black', size = 0.3),legend.position = c(0.132,0.93), legend.key.size = unit(1.5, "cm"))
ggsave("caves_protection_data_type.png", plot = last_plot(), device = "png",width = 20,height = 11.25,units = "in", dpi = 100,path = "Website_plots/")
ggplot()+
geom_col(data = caves_protection_data_summary_type, aes(x=Protection_Type_l, y= number_of_caves, fill=Protection_Type_l),width=0.8,show.legend = F)+
geom_text(data = caves_protection_data_summary_type,aes(x =Protection_Type_l,y= number_of_caves, label=number_of_caves), position=position_dodge(width=0.7), vjust=-0.25,size=5)+
scale_y_continuous(breaks = seq(0,350),limits = c(0,350))+
#scale_x_discrete(labels=Protection_Type_label)+
labs(x="Protection", y= "Number of caves")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),legend.text = element_text(size = 18),axis.text.y=element_text(margin = margin(t = 0, r = 0, b = 0, l = 10,unit = "pt"),size = 18),axis.text.x = element_text(size = 18,angle = 45, hjust = 1),axis.title = element_text(size=22),panel.border = element_blank(),axis.line.x = element_line(colour = 'black', size = 0.3), axis.line.y = element_line(colour = 'black', size = 0.3),legend.position = c(0.132,0.93), legend.key.size = unit(1.5, "cm"))
caves_protection_data_summary_type
ggplot()+
geom_col(data = caves_protection_data_summary_type, aes(x=Protection_Type_l, y= number_of_caves, fill=Protection_Type_l),width=0.8,show.legend = F)
ggplot()+
geom_col(data = caves_protection_data_summary_type, aes(x=Protection_Type_l, y= number_of_caves, fill=Protection_Type_l),width=0.8,show.legend = F)+
geom_text(data = caves_protection_data_summary_type,aes(x =Protection_Type_l,y= number_of_caves, label=number_of_caves), position=position_dodge(width=0.7), vjust=-0.25,size=5)+
scale_y_continuous(breaks = seq(0,350,50),limits = c(0,350))+
#scale_x_discrete(labels=Protection_Type_label)+
labs(x="Protection", y= "Number of caves")+
theme_bw()+
theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank(),legend.text = element_text(size = 18),axis.text.y=element_text(margin = margin(t = 0, r = 0, b = 0, l = 10,unit = "pt"),size = 18),axis.text.x = element_text(size = 18,angle = 45, hjust = 1),axis.title = element_text(size=22),panel.border = element_blank(),axis.line.x = element_line(colour = 'black', size = 0.3), axis.line.y = element_line(colour = 'black', size = 0.3),legend.position = c(0.132,0.93), legend.key.size = unit(1.5, "cm"))
ggsave("caves_protection_data_type.png", plot = last_plot(), device = "png",width = 20,height = 11.25,units = "in", dpi = 100,path = "Website_plots/")
